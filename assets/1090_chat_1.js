const _0x192c94=_0x4345;(function(_0x3aa7f2,_0x21bbc1){const _0x1f948e=_0x4345,_0x306190=_0x3aa7f2();while(!![]){try{const _0x2c4bf5=parseInt(_0x1f948e(0x228))/0x1+-parseInt(_0x1f948e(0x1e9))/0x2*(parseInt(_0x1f948e(0x1f9))/0x3)+parseInt(_0x1f948e(0x218))/0x4*(parseInt(_0x1f948e(0x216))/0x5)+parseInt(_0x1f948e(0x220))/0x6*(parseInt(_0x1f948e(0x1e7))/0x7)+parseInt(_0x1f948e(0x213))/0x8+-parseInt(_0x1f948e(0x1d0))/0x9+-parseInt(_0x1f948e(0x20c))/0xa;if(_0x2c4bf5===_0x21bbc1)break;else _0x306190['push'](_0x306190['shift']());}catch(_0x51f233){_0x306190['push'](_0x306190['shift']());}}}(_0x3002,0x47daa));const SHEET_ID=_0x192c94(0x20b),API_KEY=_0x192c94(0x201),RANGE=_0x192c94(0x1fd);let currentUser='';const messages=[];function _0x4345(_0x41bf39,_0x21c88c){const _0x300261=_0x3002();return _0x4345=function(_0x4345e2,_0x1e8f08){_0x4345e2=_0x4345e2-0x1ba;let _0x4bdde4=_0x300261[_0x4345e2];return _0x4bdde4;},_0x4345(_0x41bf39,_0x21c88c);}function showDialog(_0x54d756){const _0x3e9200=_0x192c94;document[_0x3e9200(0x203)](_0x3e9200(0x234))['textContent']=_0x54d756,document[_0x3e9200(0x203)](_0x3e9200(0x1f7))[_0x3e9200(0x1c3)][_0x3e9200(0x1d7)]=_0x3e9200(0x200);}function _0x3002(){const _0x34b64d=['key','chat-header','passwordForm','allUserData','login-name','login','display','getSeconds','submit','2-digit','remove','receiver','Mbola\x20tsy\x20ao\x20anaty\x20lisitra\x20Ianao.','isArray','textContent','values','confirmPassword','login-btn','getDate','change-password-btn','?key=','preventDefault','7PPcbjh','user-message','5004QmZlXF','Misy\x20olana\x20eo\x20amin\x27ny\x20tahiry.','fr-FR','logout-btn','toLocaleDateString','send-btn','https://script.google.com/macros/s/AKfycbwKwAQr8ke2t855GDR_mih82kK5jH8yiS_waJ6iu1lDC2olnjI7mKMjcn4Fe_olczBLVw/exec',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',':\x20ny\x20','newPassword','click','userLogins','❌\x20Diso\x20ilay\x20teny\x20miafina\x20teo\x20aloha.','error','dialog-overlay','Ianao','669dxgiXS','Tsy\x20hita\x20mihintsy\x20io\x20olona\x20io','text','✅\x20Voaova\x20soamantsara\x20ny\x20teny\x20miafina','secret!A2:B','length','scrollTop','block','AIzaSyDv9sPXdFIe3Y2fipgbBwa3MfYlGWfTwgA','POST','getElementById','❌\x20Tsy\x20mitovy\x20ilay\x20teny\x20miafina\x20vaovao\x20sy\x20ny\x20fanamafisana.','status','setItem','Groupé','Erreur\x20réseau\x20:\x20','login-password','change','1alwqsk3qiGvt8QfYqYZBHft8NpHbDM4xzOewgMKTwFg','1894930Nplgmi','Enter','cancel-button','filter','https://sheets.googleapis.com/v4/spreadsheets/','option','https://script.google.com/macros/s/AKfycbwKwAQr8ke2t855GDR_mih82kK5jH8yiS_waJ6iu1lDC2olnjI7mKMjcn4Fe_olczBLVw/exec?getAll=true','2969288GBaokp','message','catch','710YksNRT','value','2232xaZGJp','timestamp','getFullYear','15px','forEach','log','login-field','add','3346968duKPhk','#333','Diso\x20ny\x20Teny\x20Miafina.','getMonth','Mbola\x20vao\x20jerena\x20aloha...','oldPassword','then','active','132862sZPfjn','receiver-select','Misy\x20olana\x20ilay\x20fandefasana\x20hafatra\x20:','appendChild','toLocaleTimeString','contains','login-container','result','getMinutes','❌\x20Tsy\x20ao\x20anaty\x20lisitra.','addEventListener','map','dialog-message','classList','createElement','trim','chat-container','name','Réponse\x20du\x20script:','getHours','innerHTML','keydown','find','/values/','none','style','password-modal','focus','append','Ilaina\x20daholo\x20ny\x20Login\x20sy\x20ny\x20Teny\x20miafina','marginBottom','stringify','toString','json','❌\x20Nisy\x20olana\x20indray\x20tao.','DOMContentLoaded','Olana\x20avy\x20aminy\x20servera\x20:','push','894006CTxPBW'];_0x3002=function(){return _0x34b64d;};return _0x3002();}function closeDialog(){const _0x85a770=_0x192c94;document[_0x85a770(0x203)](_0x85a770(0x1f7))['style'][_0x85a770(0x1d7)]='none';}function escapeHtml(_0x217f40){const _0x1339e3=_0x192c94,_0x1b0583=document[_0x1339e3(0x236)]('div');return _0x1b0583[_0x1339e3(0x1df)]=_0x217f40,_0x1b0583['innerHTML'];}function padNumber(_0x15dbce){const _0x5a826d=_0x192c94;return _0x15dbce[_0x5a826d(0x1ca)]()['padStart'](0x2,'0');}async function fetchUserData(){const _0x1482cb=_0x192c94;try{const _0x16af28=await fetch(_0x1482cb(0x210)+SHEET_ID+_0x1482cb(0x1c1)+RANGE+_0x1482cb(0x1e5)+API_KEY),_0x555df1=await _0x16af28['json']();if(_0x555df1[_0x1482cb(0x1e0)]){const _0xdf3ca6=_0x555df1[_0x1482cb(0x1e0)][_0x1482cb(0x233)](_0x45222f=>_0x45222f[0x0]);sessionStorage[_0x1482cb(0x206)](_0x1482cb(0x1f4),JSON[_0x1482cb(0x1c9)](_0xdf3ca6)),window[_0x1482cb(0x1d4)]=_0x555df1[_0x1482cb(0x1e0)],fillReceiverList(_0x555df1['values']);}else showDialog(_0x1482cb(0x1fa));}catch(_0x4ece6c){showDialog(_0x1482cb(0x1ea));}}function fillReceiverList(_0x519813){const _0x39bfb8=_0x192c94,_0x48163a=document[_0x39bfb8(0x203)](_0x39bfb8(0x229));_0x48163a['innerHTML']='<option\x20value=\x22Groupé\x22>Groupé</option>';const _0x2de3e0=[...new Set(_0x519813['map'](_0x4e45af=>_0x4e45af[0x0]))];_0x2de3e0[_0x39bfb8(0x21c)](_0x359075=>{const _0x1bd1ff=_0x39bfb8,_0x501739=document[_0x1bd1ff(0x236)](_0x1bd1ff(0x211));_0x501739[_0x1bd1ff(0x217)]=_0x359075,_0x501739[_0x1bd1ff(0x1df)]=_0x359075,_0x48163a[_0x1bd1ff(0x22b)](_0x501739);});}async function handleLogin(){const _0x58ed5d=_0x192c94,_0x12b004=document[_0x58ed5d(0x203)](_0x58ed5d(0x1d5))['value'][_0x58ed5d(0x237)](),_0x36f8fd=document[_0x58ed5d(0x203)](_0x58ed5d(0x209))['value'][_0x58ed5d(0x237)]();if(!_0x12b004||!_0x36f8fd){showDialog(_0x58ed5d(0x1c7));return;}!window['allUserData']&&await fetchUserData();const _0x4f71be=window[_0x58ed5d(0x1d4)][_0x58ed5d(0x1c0)](_0x86d17f=>_0x86d17f[0x0]===_0x12b004);if(!_0x4f71be){showDialog(_0x58ed5d(0x1dd));return;}if(_0x4f71be[0x1]!==_0x36f8fd){showDialog(_0x58ed5d(0x222));return;}currentUser=_0x12b004,document[_0x58ed5d(0x203)]('login-container')[_0x58ed5d(0x235)][_0x58ed5d(0x1db)](_0x58ed5d(0x227)),document['getElementById'](_0x58ed5d(0x1ba))['classList'][_0x58ed5d(0x21f)]('active'),document[_0x58ed5d(0x203)](_0x58ed5d(0x1d2))[_0x58ed5d(0x1df)]='Tongasoa\x20Ianao,\x20'+currentUser,fetchMessages();}function fetchMessages(){const _0x5c1804=_0x192c94;fetch(_0x5c1804(0x212))[_0x5c1804(0x226)](_0x13971f=>{const _0x21fb13=_0x5c1804;if(!_0x13971f['ok'])throw new Error(_0x21fb13(0x208)+_0x13971f[_0x21fb13(0x205)]);return _0x13971f['json']();})[_0x5c1804(0x226)](_0x322bec=>{const _0x2a3b16=_0x5c1804;if(!Array[_0x2a3b16(0x1de)](_0x322bec)){_0x322bec&&_0x322bec[_0x2a3b16(0x22f)]==='error'?console[_0x2a3b16(0x1f6)](_0x2a3b16(0x1ce),_0x322bec['message']):console[_0x2a3b16(0x1f6)]('Diso\x20ny\x20format\x20:',_0x322bec);return;}messages[_0x2a3b16(0x1fe)]=0x0,messages[_0x2a3b16(0x1cf)](..._0x322bec),filterMessages();})['catch'](_0x3a3e2c=>{const _0x1dfb98=_0x5c1804;console[_0x1dfb98(0x1f6)](_0x1dfb98(0x22a),_0x3a3e2c['message']||_0x3a3e2c);});}function filterMessages(){const _0x7852e2=_0x192c94,_0x4f8644=document['getElementById'](_0x7852e2(0x229))[_0x7852e2(0x217)],_0x5a3883=messages[_0x7852e2(0x20f)](_0x56cd5a=>{const _0x410d3b=_0x7852e2,_0x3956e2=String(_0x56cd5a[_0x410d3b(0x1bb)]||'')[_0x410d3b(0x237)](),_0x5cc14e=String(_0x56cd5a[_0x410d3b(0x1dc)]||'')[_0x410d3b(0x237)]();return _0x4f8644===_0x410d3b(0x207)?_0x5cc14e===_0x410d3b(0x207):_0x3956e2===currentUser&&_0x5cc14e===_0x4f8644||_0x3956e2===_0x4f8644&&_0x5cc14e===currentUser;});renderFilteredMessages(_0x5a3883);}function renderFilteredMessages(_0x2e37cb){const _0x59a0db=_0x192c94,_0x21527d=document[_0x59a0db(0x203)]('messages');_0x21527d[_0x59a0db(0x1be)]='',_0x2e37cb[_0x59a0db(0x21c)](_0x40e41c=>{const _0x5667ce=_0x59a0db,_0x51d0ac=String(_0x40e41c[_0x5667ce(0x1bb)]||'')[_0x5667ce(0x237)](),_0x5beff6=_0x51d0ac===currentUser,_0x4c6e96=new Date(_0x40e41c[_0x5667ce(0x219)]['replace']('\x20','T')),_0x3960b5=_0x4c6e96[_0x5667ce(0x1ed)](_0x5667ce(0x1eb)),_0x3b7c68=_0x4c6e96[_0x5667ce(0x22c)](_0x5667ce(0x1eb),{'hour':_0x5667ce(0x1da),'minute':_0x5667ce(0x1da)}),_0x4fbcf8=_0x5beff6?_0x5667ce(0x1f8):escapeHtml(_0x51d0ac),_0x1f5f76=document[_0x5667ce(0x236)]('div');_0x1f5f76[_0x5667ce(0x235)][_0x5667ce(0x21f)](_0x5667ce(0x214)),_0x1f5f76[_0x5667ce(0x1c3)][_0x5667ce(0x1c8)]=_0x5667ce(0x21b),_0x1f5f76['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20bold;\x20color:\x20'+(_0x5beff6?'#007bff':_0x5667ce(0x221))+_0x5667ce(0x1f0)+_0x4fbcf8+_0x5667ce(0x1f1)+_0x3960b5+'\x20tamin\x27ny\x20'+_0x3b7c68+'\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-left:\x2010px;\x20white-space:\x20pre-wrap;\x22>'+escapeHtml(_0x40e41c[_0x5667ce(0x1fb)])+'</div>\x0a\x20\x20\x20\x20',_0x21527d[_0x5667ce(0x22b)](_0x1f5f76);}),_0x21527d[_0x59a0db(0x1ff)]=_0x21527d['scrollHeight'];}function sendMessage(){const _0x26a2c8=_0x192c94,_0x2ecf2c=document[_0x26a2c8(0x203)](_0x26a2c8(0x1e8)),_0x4e2351=document[_0x26a2c8(0x203)](_0x26a2c8(0x229))[_0x26a2c8(0x217)],_0x4e05e4=_0x2ecf2c['value'][_0x26a2c8(0x237)]();if(!_0x4e05e4)return;const _0x38a273=new Date(),_0x4c10e3=_0x38a273[_0x26a2c8(0x21a)]()+'-'+padNumber(_0x38a273[_0x26a2c8(0x223)]()+0x1)+'-'+padNumber(_0x38a273[_0x26a2c8(0x1e3)]())+'\x20'+padNumber(_0x38a273[_0x26a2c8(0x1bd)]())+':'+padNumber(_0x38a273[_0x26a2c8(0x230)]())+':'+padNumber(_0x38a273[_0x26a2c8(0x1d8)]()),_0x167769={'name':currentUser,'text':_0x4e05e4,'receiver':_0x4e2351,'timestamp':_0x4c10e3};messages[_0x26a2c8(0x1cf)](_0x167769),renderMessages(),_0x2ecf2c['value']='',_0x2ecf2c[_0x26a2c8(0x1c5)](),sendMessageToSheet(_0x167769);}function sendMessageToSheet({name:_0xd6d8d8,text:_0x7e30c3,receiver:_0x5b1d62}){const _0x44d37d=_0x192c94,_0x2350ab=_0x44d37d(0x1ef),_0x3c5194=new FormData();_0x3c5194[_0x44d37d(0x1c6)](_0x44d37d(0x1bb),_0xd6d8d8),_0x3c5194[_0x44d37d(0x1c6)](_0x44d37d(0x214),_0x7e30c3),_0x3c5194['append'](_0x44d37d(0x1dc),_0x5b1d62),fetch(_0x2350ab,{'method':_0x44d37d(0x202),'body':_0x3c5194,'mode':'cors'})[_0x44d37d(0x226)](_0x32b39a=>_0x32b39a[_0x44d37d(0x1fb)]())['then'](_0x31b713=>console[_0x44d37d(0x21d)](_0x44d37d(0x1bc),_0x31b713))[_0x44d37d(0x215)](_0x468d7e=>console[_0x44d37d(0x1f6)]('Erreur\x20en\x20envoyant\x20le\x20message\x20:',_0x468d7e));}function renderMessages(){filterMessages();}const sheetId_mdp=_0x192c94(0x20b),apiKey1='AIzaSyDv9sPXdFIe3Y2fipgbBwa3MfYlGWfTwgA',range=_0x192c94(0x1fd),webAppUrl='https://script.google.com/macros/s/AKfycbxg59_S_cMIxgt7qVs42NG8JdD-jw0bOUyLjN3SWTgG0XHtet_ULG0Q0g5mR2vhPnAEmg/exec',form=document[_0x192c94(0x203)](_0x192c94(0x1d3)),result=document[_0x192c94(0x203)](_0x192c94(0x22f));form[_0x192c94(0x232)](_0x192c94(0x1d9),async function(_0x5607cd){const _0x38dfe8=_0x192c94;_0x5607cd[_0x38dfe8(0x1e6)]();const _0x243e80=form['login']['value']['trim'](),_0x4f1907=form[_0x38dfe8(0x225)][_0x38dfe8(0x217)]['trim'](),_0x3239d1=form[_0x38dfe8(0x1f2)]['value'][_0x38dfe8(0x237)](),_0x32ea02=form[_0x38dfe8(0x1e1)][_0x38dfe8(0x217)][_0x38dfe8(0x237)]();result['textContent']=_0x38dfe8(0x224);if(_0x3239d1!==_0x32ea02){result['textContent']=_0x38dfe8(0x204),setTimeout(()=>{const _0x12c093=_0x38dfe8;result[_0x12c093(0x1df)]='';},0xbb8);return;}const _0x2f6db0=_0x38dfe8(0x210)+sheetId_mdp+'/values/'+range+_0x38dfe8(0x1e5)+apiKey1;try{const _0x28ada6=await fetch(_0x2f6db0),_0x15cfa5=await _0x28ada6[_0x38dfe8(0x1cb)](),_0x36eb1c=_0x15cfa5['values'],_0x275ba7=_0x36eb1c[_0x38dfe8(0x1c0)](_0x143d48=>_0x143d48[0x0]===_0x243e80);if(!_0x275ba7){result['textContent']=_0x38dfe8(0x231),setTimeout(()=>{const _0x34dbcc=_0x38dfe8;result[_0x34dbcc(0x1df)]='';},0xbb8);return;}if(_0x275ba7[0x1]!==_0x4f1907){result[_0x38dfe8(0x1df)]=_0x38dfe8(0x1f5),setTimeout(()=>{const _0x65bf91=_0x38dfe8;result[_0x65bf91(0x1df)]='';},0xbb8);return;}const _0x530cbb=new FormData();_0x530cbb[_0x38dfe8(0x1c6)](_0x38dfe8(0x1d6),_0x243e80),_0x530cbb['append']('password',_0x3239d1);const _0x318369=await fetch(webAppUrl,{'method':'POST','body':_0x530cbb}),_0x26bb2b=await _0x318369[_0x38dfe8(0x1fb)]();result[_0x38dfe8(0x1df)]=_0x38dfe8(0x1fc),setTimeout(()=>{const _0x5272d6=_0x38dfe8;result[_0x5272d6(0x1df)]='';},0xbb8);}catch(_0x2fed4f){console[_0x38dfe8(0x1f6)](_0x2fed4f),result[_0x38dfe8(0x1df)]=_0x38dfe8(0x1cc),result[_0x38dfe8(0x1df)]=_0x38dfe8(0x1fc),setTimeout(()=>{result['textContent']='';},0xbb8);}}),document[_0x192c94(0x203)]('refresh-btn')['addEventListener']('click',fetchMessages),document[_0x192c94(0x203)](_0x192c94(0x1e2))['addEventListener'](_0x192c94(0x1f3),handleLogin),document[_0x192c94(0x203)](_0x192c94(0x1ee))[_0x192c94(0x232)](_0x192c94(0x1f3),sendMessage),document['getElementById']('receiver-select')[_0x192c94(0x232)](_0x192c94(0x20a),filterMessages),document[_0x192c94(0x203)](_0x192c94(0x1e4))[_0x192c94(0x232)]('click',()=>{const _0x394bec=_0x192c94;document['getElementById'](_0x394bec(0x21e))[_0x394bec(0x217)]=currentUser,document[_0x394bec(0x203)](_0x394bec(0x1c4))[_0x394bec(0x1c3)][_0x394bec(0x1d7)]=_0x394bec(0x200);}),document[_0x192c94(0x232)](_0x192c94(0x1bf),function(_0x304533){const _0xd09cdc=_0x192c94;_0x304533[_0xd09cdc(0x1d1)]===_0xd09cdc(0x20d)&&(_0x304533[_0xd09cdc(0x1e6)](),document['getElementById'](_0xd09cdc(0x22e))[_0xd09cdc(0x235)][_0xd09cdc(0x22d)](_0xd09cdc(0x227))?handleLogin():sendMessage());});const modal=document['getElementById'](_0x192c94(0x1c4)),cancelBtn=document[_0x192c94(0x203)](_0x192c94(0x20e));cancelBtn[_0x192c94(0x232)](_0x192c94(0x1f3),()=>{const _0x434880=_0x192c94;modal[_0x434880(0x1c3)][_0x434880(0x1d7)]='none';}),document[_0x192c94(0x232)](_0x192c94(0x1bf),_0x1cbe02=>{const _0x334f76=_0x192c94;_0x1cbe02[_0x334f76(0x1d1)]==='Escape'&&modal[_0x334f76(0x1c3)][_0x334f76(0x1d7)]===_0x334f76(0x200)&&(modal[_0x334f76(0x1c3)][_0x334f76(0x1d7)]=_0x334f76(0x1c2));}),document[_0x192c94(0x203)](_0x192c94(0x1ec))[_0x192c94(0x232)](_0x192c94(0x1f3),function(){const _0x228fa0=_0x192c94;currentUser='',document['getElementById'](_0x228fa0(0x1d5))['value']='',document[_0x228fa0(0x203)](_0x228fa0(0x209))[_0x228fa0(0x217)]='',document[_0x228fa0(0x203)](_0x228fa0(0x1ba))[_0x228fa0(0x235)]['remove'](_0x228fa0(0x227)),document[_0x228fa0(0x203)](_0x228fa0(0x22e))[_0x228fa0(0x235)][_0x228fa0(0x21f)](_0x228fa0(0x227));}),window[_0x192c94(0x232)](_0x192c94(0x1cd),fetchUserData);